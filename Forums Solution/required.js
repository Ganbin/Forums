function customLoginListener(login, password) {    "use strict";	var promoteToken;		promoteToken = currentSession().promoteWith('Administrateur');     var dsUser = {},        authenticated = false,		theGroupsTemp= [],		theGroups = [],		dataStorage = [],        retObj = {},        result;     if (login === "admin" || login === "dataAdmin") { //pass auth over to wakanda directory         //note that the ds isn't always loaded when this runs, so have to        //check for hardcoded admin names here        result = false;     } else { 	        dsUser = ds.User.find('login = :1 or email = :1', login);                 if (dsUser !== null) {             //we found a user with the given login, now auth the password            authenticated = dsUser.validatePassword(password);            //build success or error object            if(authenticated === true && dsUser.statut === 'validated'){								if(dsUser.allGroups != 'undefined'){					if(dsUser.allGroups.length !== 0){												theGroupsTemp = dsUser.allGroups.toArray('title');												for(var i = 0; i <theGroupsTemp.length;i++){							dataStorage.push(theGroupsTemp[i]['title']);														if(theGroupsTemp[i]['title'] === 'dataAdmin'){								theGroups = ['Administrateur']							}													}											}				}								if(theGroups.length == 0){					theGroups = ['User']				}				                retObj =  {                    ID: dsUser.ID,                    name: dsUser.login,                    fullName: dsUser.fullName,                    belongsTo: theGroups,					storage: {groups:dataStorage,userID:dsUser.ID}                };	        } else {				if(dsUser.statut !== 'emailValidated'){					retObj = {	         	       error: 1,	         	       errorMessage: 'Please validate your account. An email was send to your registration email address.'	         	   };				}else{	         	   retObj = {	         	       error: 2,	         	       errorMessage: 'invalid login and/or password'	         	   };				}	        }         //return sucess or error object        result = retObj;         } else { //pass auth over to wakanda directory			retObj = {         		error: 2,         		errorMessage: 'invalid login and/or password'         	};            result = retObj;        }     } 	currentSession().unPromote(promoteToken);    return result;}