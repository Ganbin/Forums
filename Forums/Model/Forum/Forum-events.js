model.Forum.events.validate = function() {	if(this.title == '' || this.title == null ){		return {error : 40, errorMessage:'Must have a title'};	}	if(this.category === null){		return {error : 41, errorMessage:'Must have a category'};	}};model.Forum.events.save = function() {	if(this.title == '' || this.title == null ){		return {error : 40, errorMessage:'Must have a title'};	}	if(this.category === null){		return {error : 41, errorMessage:'Must have a category'};	}};model.Forum.events.restrict = function() {		var namespace = require('namespace');		var returnCol = ds.Forum.createEntityCollection();	var curSess = currentSession();	var allPublicAccesses;	var allUserAccesses;	var promoteToken;	var accessIDArray = [];	var forumResult;	if(curSess.belongsTo('Administrateur') || curSess.belongsTo('Admin')){		returnCol = ds.Forum.all();	}else if(curSess.user.fullName === 'default guest'){ // Si la personne n'est pas logguer				promoteToken = curSess.promoteWith('Read_Access');				allPublicAccesses = ds.Access.query('group.ID == :1',namespace.getPublicGroupID());				accessIDArray = allPublicAccesses.ID;				forumResult = ds.Forum.query('allAccesses.ID in :1 and topics.posts # null',accessIDArray);//		forumResult = allPublicAccesses.forum.query('topics.posts # null');				returnCol.add(forumResult);						curSess.unPromote(promoteToken);			}else{				promoteToken = curSess.promoteWith('Read_Access');				allUserAccesses = ds.Access.query('user.ID == :1 or group.allUsers.ID == :1 or group{2}.ID == :2',curSess.storage.userID,namespace.getPublicGroupID());				accessIDArray = allUserAccesses.ID;				forumResult = ds.Forum.query('allAccesses.ID in :1 or visible == true',accessIDArray);//		forumResult = allUserAccesses.forum.query('visible == true');				returnCol.add(forumResult);				curSess.unPromote(promoteToken);			}		return returnCol;	};model.Forum.events.remove = function() {	var topics = ds.Topic.query('forum.ID == :1',this.ID);	var accesses = ds.Access.query('forum.ID == :1',this.ID);			if(topics.length !== 0){		return {error : 42, errorMessage:'You cannot remove this forum because it contain topic(s).'};	}else if(accesses.length !== 0){		return {error : 43, errorMessage:'You cannot remove this forum because it have access(es).'};	}};